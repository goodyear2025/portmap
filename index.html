<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>13:51 Mapbox 30 March 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.10.0/mapbox-gl.js"></script>
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
</head>
<body>
<div id="map"></div>
<script>
  // ================================================
  // üî∑ Mapbox Ë°®Á§∫Ë®≠ÂÆö„É´„Éº„É´Ôºà2025-03-30 ÊôÇÁÇπÔºâ
  // 
  // [Tileset Name]
  // Global_PortData-1f8m8n
  //
  // [Data Fields]
  // Country, PortName, PortNo, Area, Region, LOCODE, Latitude, Longitude,
  // Avg. Annual Port calls, Primary
  //
  // [Port Circle Icon „É´„Éº„É´]
  // - Ê®ôÊ∫ñÔºö#000000
  // - Avg. Annual Port calls = 0 ‚Üí #a9a9a9Ôºà„Ç∞„É¨„ÉºÔºâ
  // - Primary = 1 ‚Üí #ff0000ÔºàËµ§Ôºâ
  //
  // [Popup Ë°®Á§∫„É´„Éº„É´]
  // - È†ÜÂ∫è:
  //   1. PortNameÔºàÂ§™Â≠óÔºâ
  //   2. Area, Country, RegionÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ
  //   3. LOCODE
  //   4. PortNoÔºà„Éè„Ç§„Éë„Éº„É™„É≥„ÇØÔºöCruiseMapperÔºâ
  //   5. Google MapÔºà„Éè„Ç§„Éë„Éº„É™„É≥„ÇØÔºöÂ∫ßÊ®ôÔºâ
  // - ÂÖ®„Å¶ target="_blank" „ÅßÂà•„Ç¶„Ç£„É≥„Éâ„Ç¶Ë°®Á§∫
  // ================================================

  // ‚úÖ Mapbox„Ç¢„ÇØ„Çª„Çπ„Éà„Éº„ÇØ„É≥
  mapboxgl.accessToken = 'pk.eyJ1IjoiZ29vZHllYXIyMDI1IiwiYSI6ImNtOHU3dDk4YjBoZzMyaXM2emVjbmNpeWQifQ.U94pBVke-OvZ0UBlhmTXvA';

  // ‚úÖ Âú∞Âõ≥ÂàùÊúüÂåñÔºàËÉåÊôØ„Çπ„Çø„Ç§„É´„Éª‰∏≠ÂøÉÂ∫ßÊ®ô„Éª„Ç∫„Éº„É†Ôºâ
  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/goodyear2025/cm8ugp7ze00xo01rd3v7273y5',
    center: [139.865044, 35.377470],
    zoom: 5
  });

  map.on('load', () => {
    // ‚úÖ „Éá„Éº„Çø„ÇΩ„Éº„Çπ„ÇíÈáçË§áÁôªÈå≤„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´„ÉÅ„Çß„ÉÉ„ÇØ
    if (!map.getSource('ports')) {
      map.addSource('ports', {
        type: 'vector',
        url: 'mapbox://goodyear2025.bdjj18br'
      });
    }

    // ‚úÖ „É¨„Ç§„É§„Éº„ÇÇÈáçË§áÁôªÈå≤„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´„ÉÅ„Çß„ÉÉ„ÇØ
    if (!map.getLayer('Port Circle Icon')) {
      map.addLayer({
        id: 'Port Circle Icon',
        type: 'circle',
        source: 'ports',
        'source-layer': 'Global_PortData-1f8m8n',
        paint: {
          'circle-radius': 12,
          'circle-color': '#ff0000'// Ëµ§
        }
      });
    }

    // ‚úÖ „Éù„Éº„Éà„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„Å´„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„ÇíË°®Á§∫
    map.on('click', 'Port Circle Icon', (e) => {
      const props = e.features[0].properties;
      const coords = e.features[0].geometry.coordinates;
      console.log('typeof Primary:', typeof props.Primary, 'value:', props.Primary);
      console.log('typeof Avg. Annual Port calls:', typeof props['Avg. Annual Port calls'], 'value:', props['Avg. Annual Port calls']);

      // Google Maps / CruiseMapper „ÅÆURLÁîüÊàê
      const googleMapUrl = `https://www.google.com/maps?q=${props.Latitude},${props.Longitude}`;
      const cruiseMapperUrl = `https://www.cruisemapper.com/?poi=${props.PortNo}`;

      // ‚úÖ „Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„ÅÆ‰∏≠Ë∫´ÔºàÈ†ÜÂ∫è„Éª„É™„É≥„ÇØ‰ªò„ÅçÔºâ
      const description = `
        <strong>${props.PortName}</strong><br>
        ${props.Area}, ${props.Country}, ${props.Region}<br>
        Primary: ${props.Primary}<br>
        LOCODE: ${props.LOCODE}<br>
        <a href="${googleMapUrl}" target="_blank">Google Map</a><br>
        <a href="${cruiseMapperUrl}" target="_blank">CruiseMapper</a>
      `;

      new mapboxgl.Popup()
        .setLngLat(coords)
        .setHTML(description)
        .addTo(map);
    });

    // ‚úÖ „Éû„Éº„Ç´„Éº„Å´„Ç´„Éº„ÇΩ„É´„ÇíÂêà„Çè„Åõ„Åü„Å®„Åç„ÅÆ„Çπ„Çø„Ç§„É´Â§âÊõ¥
    map.on('mouseenter', 'Port Circle Icon', () => {
      map.getCanvas().style.cursor = 'pointer';
    });

    map.on('mouseleave', 'Port Circle Icon', () => {
      map.getCanvas().style.cursor = '';
    });
  });
</script>
</body>
</html>
